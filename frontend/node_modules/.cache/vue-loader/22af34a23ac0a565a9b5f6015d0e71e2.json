{"remainingRequest":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\House-Price-Analysis-Spark\\frontend\\src\\views\\Profile.vue?vue&type=style&index=0&id=ced23842&scoped=true&lang=css","dependencies":[{"path":"E:\\House-Price-Analysis-Spark\\frontend\\src\\views\\Profile.vue","mtime":1770781004485},{"path":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\css-loader\\dist\\cjs.js","mtime":1769265187885},{"path":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1769265187974},{"path":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":1769265187675},{"path":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1769265189153},{"path":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1769265187754}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5wcm9maWxlLWNvbnRhaW5lciB7CiAgcGFkZGluZzogMjBweDsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjVmN2ZhOwogIG1pbi1oZWlnaHQ6IGNhbGMoMTAwdmggLSA2MHB4KTsKfQoKLm1lbnUtY2FyZCwgLmNvbnRlbnQtY2FyZCB7CiAgYm9yZGVyLXJhZGl1czogOHB4OwogIGJveC1zaGFkb3c6IDAgMnB4IDEycHggcmdiYSgwLDAsMCwwLjEpOwp9CgoubWVudS1oZWFkZXIsIC5jb250ZW50LWhlYWRlciB7CiAgdGV4dC1hbGlnbjogY2VudGVyOwp9CgoubWVudS1oZWFkZXIgaDMsIC5jb250ZW50LWhlYWRlciBoMyB7CiAgbWFyZ2luOiAwOwogIGNvbG9yOiAjMzMzOwp9CgoucHJvZmlsZS1tZW51IHsKICBib3JkZXI6IG5vbmU7Cn0KCi5wcm9maWxlLW1lbnUgLmVsLW1lbnUtaXRlbSB7CiAgaGVpZ2h0OiA1MHB4OwogIGxpbmUtaGVpZ2h0OiA1MHB4Owp9CgoucHJvZmlsZS1tZW51IC5lbC1tZW51LWl0ZW06aG92ZXIgewogIGJhY2tncm91bmQtY29sb3I6ICNmNWY3ZmE7Cn0KCi5wcm9maWxlLW1lbnUgLmVsLW1lbnUtaXRlbS5pcy1hY3RpdmUgewogIGJhY2tncm91bmQtY29sb3I6ICM2NjdlZWE7CiAgY29sb3I6IHdoaXRlOwp9CgouZW1wdHktc3RhdGUgewogIHRleHQtYWxpZ246IGNlbnRlcjsKICBwYWRkaW5nOiA1MHB4IDIwcHg7CiAgY29sb3I6ICM5MDkzOTk7Cn0KCi5lbXB0eS1zdGF0ZSBpIHsKICBmb250LXNpemU6IDQ4cHg7CiAgbWFyZ2luLWJvdHRvbTogMTBweDsKICBkaXNwbGF5OiBibG9jazsKfQoKLmZhdm9yaXRlLWl0ZW0sIC5jb21tZW50LWl0ZW0sIC52aWV3LWl0ZW0gewogIG1hcmdpbi1ib3R0b206IDE1cHg7Cn0KCi5mYXZvcml0ZS1jb250ZW50LCAuY29tbWVudC1jb250ZW50LCAudmlldy1jb250ZW50IHsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICBhbGlnbi1pdGVtczogY2VudGVyOwp9CgouZmF2b3JpdGUtaW5mbywgLnZpZXctaW5mbyB7CiAgZmxleDogMTsKfQoKLmZhdm9yaXRlLWluZm8gaDQsIC52aWV3LWluZm8gaDQgewogIG1hcmdpbjogMCAwIDVweCAwOwogIGNvbG9yOiAjMzMzOwp9CgouZmF2b3JpdGUtaW5mbyBwLCAudmlldy1pbmZvIHAgewogIG1hcmdpbjogMCAwIDVweCAwOwogIGNvbG9yOiAjNjY2OwogIGZvbnQtc2l6ZTogMTRweDsKfQoKLnByaWNlIHsKICBjb2xvcjogI2ZmNmI2YjsKICBmb250LXdlaWdodDogYm9sZDsKICBmb250LXNpemU6IDE2cHg7Cn0KCi5jb21tZW50LWhlYWRlciB7CiAgZGlzcGxheTogZmxleDsKICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICBtYXJnaW4tYm90dG9tOiAxMHB4Owp9CgouaG91c2UtbmFtZSB7CiAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgY29sb3I6ICMzMzM7Cn0KCi5jb21tZW50LXRleHQgewogIG1hcmdpbjogMTBweCAwOwogIGNvbG9yOiAjNjY2OwogIGxpbmUtaGVpZ2h0OiAxLjY7Cn0KCi5jb21tZW50LWZvb3RlciB7CiAgdGV4dC1hbGlnbjogcmlnaHQ7Cn0KCi5jb21tZW50LXRpbWUgewogIGNvbG9yOiAjOTA5Mzk5OwogIGZvbnQtc2l6ZTogMTJweDsKfQoKLnZpZXctdGltZSB7CiAgY29sb3I6ICM5MDkzOTk7CiAgZm9udC1zaXplOiAxMnB4Owp9Cg=="},{"version":3,"sources":["Profile.vue"],"names":[],"mappings":";AAmVA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Profile.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"profile-container\">\n    <el-row :gutter=\"20\">\n      <!-- 左侧导航菜单 -->\n      <el-col :span=\"6\">\n        <el-card class=\"menu-card\">\n          <div slot=\"header\" class=\"menu-header\">\n            <h3>个人中心</h3>\n          </div>\n          <el-menu\n            :default-active=\"activeMenu\"\n            class=\"profile-menu\"\n            @select=\"handleMenuSelect\"\n          >\n            <el-menu-item index=\"favorites\">\n              <i class=\"el-icon-star-off\"></i>\n              <span>我的收藏</span>\n            </el-menu-item>\n            <el-menu-item index=\"comments\">\n              <i class=\"el-icon-chat-dot-round\"></i>\n              <span>我的评论</span>\n            </el-menu-item>\n            <el-menu-item index=\"views\">\n              <i class=\"el-icon-view\"></i>\n              <span>浏览记录</span>\n            </el-menu-item>\n            <el-menu-item index=\"profile\">\n              <i class=\"el-icon-user\"></i>\n              <span>修改资料</span>\n            </el-menu-item>\n          </el-menu>\n        </el-card>\n      </el-col>\n      \n      <!-- 右侧内容区域 -->\n      <el-col :span=\"18\">\n        <!-- 我的收藏 -->\n        <el-card v-show=\"activeMenu === 'favorites'\" class=\"content-card\">\n          <div slot=\"header\" class=\"content-header\">\n            <h3>我的收藏</h3>\n          </div>\n          <div v-if=\"favorites.length === 0\" class=\"empty-state\">\n            <i class=\"el-icon-star-off\"></i>\n            <p>暂无收藏记录</p>\n          </div>\n          <div v-else class=\"favorites-list\">\n            <el-card \n              v-for=\"favorite in favorites\" \n              :key=\"favorite.id\" \n              class=\"favorite-item\"\n            >\n              <div class=\"favorite-content\">\n                <div class=\"favorite-info\">\n                  <h4>{{ favorite.house_name }}</h4>\n                  <p>{{ favorite.address }}</p>\n                  <span class=\"price\">¥{{ favorite.price }}/月</span>\n                </div>\n                <el-button \n                  type=\"danger\" \n                  icon=\"el-icon-delete\" \n                  @click=\"removeFavorite(favorite.id)\"\n                  size=\"small\"\n                >\n                  取消收藏\n                </el-button>\n              </div>\n            </el-card>\n          </div>\n        </el-card>\n        \n        <!-- 我的评论 -->\n        <el-card v-show=\"activeMenu === 'comments'\" class=\"content-card\">\n          <div slot=\"header\" class=\"content-header\">\n            <h3>我的评论</h3>\n          </div>\n          <div v-if=\"comments.length === 0\" class=\"empty-state\">\n            <i class=\"el-icon-chat-dot-round\"></i>\n            <p>暂无评论记录</p>\n          </div>\n          <div v-else class=\"comments-list\">\n            <el-card \n              v-for=\"comment in comments\" \n              :key=\"comment.id\" \n              class=\"comment-item\"\n            >\n              <div class=\"comment-content\">\n                <div class=\"comment-header\">\n                  <span class=\"house-name\">{{ comment.house_name }}</span>\n                  <el-rate\n                    v-model=\"comment.rating\"\n                    disabled\n                    show-score\n                    text-color=\"#ff9900\"\n                    score-template=\"{value}分\"\n                  ></el-rate>\n                </div>\n                <p class=\"comment-text\">{{ comment.content }}</p>\n                <div class=\"comment-footer\">\n                  <span class=\"comment-time\">{{ comment.created_at }}</span>\n                </div>\n              </div>\n            </el-card>\n          </div>\n        </el-card>\n        \n        <!-- 浏览记录 -->\n        <el-card v-show=\"activeMenu === 'views'\" class=\"content-card\">\n          <div slot=\"header\" class=\"content-header\">\n            <h3>浏览记录</h3>\n          </div>\n          <div v-if=\"viewRecords.length === 0\" class=\"empty-state\">\n            <i class=\"el-icon-view\"></i>\n            <p>暂无浏览记录</p>\n          </div>\n          <div v-else class=\"views-list\">\n            <el-card \n              v-for=\"record in viewRecords\" \n              :key=\"record.id\" \n              class=\"view-item\"\n            >\n              <div class=\"view-content\">\n                <div class=\"view-info\">\n                  <h4>{{ record.house_name }}</h4>\n                  <p>{{ record.address }}</p>\n                  <span class=\"view-time\">{{ record.viewed_at }}</span>\n                </div>\n                <el-button \n                  type=\"primary\" \n                  @click=\"viewHouseDetail(record.house_id)\"\n                  size=\"small\"\n                >\n                  查看详情\n                </el-button>\n              </div>\n            </el-card>\n          </div>\n        </el-card>\n        \n        <!-- 修改资料 -->\n        <el-card v-show=\"activeMenu === 'profile'\" class=\"content-card\">\n          <div slot=\"header\" class=\"content-header\">\n            <h3>修改个人资料</h3>\n          </div>\n          <el-form \n            :model=\"profileForm\" \n            :rules=\"profileRules\" \n            ref=\"profileForm\" \n            label-width=\"100px\"\n          >\n            <el-form-item label=\"用户名\">\n              <el-input v-model=\"profileForm.username\" disabled></el-input>\n            </el-form-item>\n            <el-form-item label=\"昵称\" prop=\"nickname\">\n              <el-input v-model=\"profileForm.nickname\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"邮箱\" prop=\"email\">\n              <el-input v-model=\"profileForm.email\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"手机号\" prop=\"phone\">\n              <el-input v-model=\"profileForm.phone\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"性别\">\n              <el-select v-model=\"profileForm.gender\">\n                <el-option label=\"男\" value=\"男\"></el-option>\n                <el-option label=\"女\" value=\"女\"></el-option>\n                <el-option label=\"未知\" value=\"未知\"></el-option>\n              </el-select>\n            </el-form-item>\n            <el-form-item label=\"城市\">\n              <el-input v-model=\"profileForm.city\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"头像URL\">\n              <el-input v-model=\"profileForm.avatar\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"出生日期\">\n              <el-date-picker \n                v-model=\"profileForm.birth_date\" \n                type=\"date\" \n                value-format=\"yyyy-MM-dd\"\n              ></el-date-picker>\n            </el-form-item>\n            <el-form-item>\n              <el-button type=\"primary\" @click=\"updateProfile\" :loading=\"saving\">保存修改</el-button>\n              <el-button @click=\"resetForm\">重置</el-button>\n            </el-form-item>\n          </el-form>\n        </el-card>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'Profile',\n  data() {\n    return {\n      activeMenu: 'favorites',\n      saving: false,\n      favorites: [],\n      comments: [],\n      viewRecords: [],\n      profileForm: {\n        username: '',\n        nickname: '',\n        email: '',\n        phone: '',\n        gender: '未知',\n        city: '',\n        avatar: '',\n        birth_date: ''\n      },\n      profileRules: {\n        nickname: [\n          { required: true, message: '请输入昵称', trigger: 'blur' }\n        ],\n        email: [\n          { required: true, message: '请输入邮箱', trigger: 'blur' },\n          { type: 'email', message: '请输入正确的邮箱格式', trigger: 'blur' }\n        ]\n      }\n    }\n  },\n  async mounted() {\n    await this.loadUserData()\n    await this.loadFavorites()\n    await this.loadComments()\n    await this.loadViewRecords()\n  },\n  methods: {\n    handleMenuSelect(key) {\n      this.activeMenu = key\n    },\n    \n    async loadUserData() {\n      try {\n        const userInfo = localStorage.getItem('userInfo')\n        if (userInfo) {\n          const user = JSON.parse(userInfo)\n          this.profileForm = {\n            username: user.username,\n            nickname: user.nickname || user.username,\n            email: user.email,\n            phone: user.phone || '',\n            gender: user.gender || '未知',\n            city: user.city || '',\n            avatar: user.avatar || '',\n            birth_date: user.birth_date || ''\n          }\n        }\n      } catch (error) {\n        console.error('加载用户数据失败:', error)\n      }\n    },\n    \n    async loadFavorites() {\n      try {\n        const response = await this.$http.get('/api/user/favorites/')\n        if (response.data.success) {\n          this.favorites = response.data.data\n        }\n      } catch (error) {\n        console.error('加载收藏失败:', error)\n      }\n    },\n    \n    async loadComments() {\n      try {\n        const response = await this.$http.get('/api/user/comments/')\n        if (response.data.success) {\n          this.comments = response.data.data\n        }\n      } catch (error) {\n        console.error('加载评论失败:', error)\n      }\n    },\n    \n    async loadViewRecords() {\n      try {\n        const response = await this.$http.get('/api/user/view-records/')\n        if (response.data.success) {\n          this.viewRecords = response.data.data\n        }\n      } catch (error) {\n        console.error('加载浏览记录失败:', error)\n      }\n    },\n    \n    async removeFavorite(id) {\n      try {\n        await this.$http.delete(`/api/user/favorites/${id}/`)\n        this.$message.success('取消收藏成功')\n        await this.loadFavorites()\n      } catch (error) {\n        console.error('取消收藏失败:', error)\n        this.$message.error('操作失败')\n      }\n    },\n    \n    viewHouseDetail(houseId) {\n      this.$router.push(`/houses/detail/${houseId}`)\n    },\n    \n    async updateProfile() {\n      this.$refs.profileForm.validate(async (valid) => {\n        if (valid) {\n          this.saving = true\n          try {\n            const response = await this.$http.put('/api/user/profile/', this.profileForm)\n            if (response.data.success) {\n              this.$message.success('资料更新成功')\n              // 更新本地存储\n              const userInfo = {\n                ...JSON.parse(localStorage.getItem('userInfo')),\n                ...this.profileForm\n              }\n              localStorage.setItem('userInfo', JSON.stringify(userInfo))\n            } else {\n              this.$message.error(response.data.message)\n            }\n          } catch (error) {\n            console.error('更新资料失败:', error)\n            this.$message.error('更新失败')\n          } finally {\n            this.saving = false\n          }\n        }\n      })\n    },\n    \n    resetForm() {\n      this.$refs.profileForm.resetFields()\n      this.loadUserData()\n    }\n  }\n}\n</script>\n\n<style scoped>\n.profile-container {\n  padding: 20px;\n  background-color: #f5f7fa;\n  min-height: calc(100vh - 60px);\n}\n\n.menu-card, .content-card {\n  border-radius: 8px;\n  box-shadow: 0 2px 12px rgba(0,0,0,0.1);\n}\n\n.menu-header, .content-header {\n  text-align: center;\n}\n\n.menu-header h3, .content-header h3 {\n  margin: 0;\n  color: #333;\n}\n\n.profile-menu {\n  border: none;\n}\n\n.profile-menu .el-menu-item {\n  height: 50px;\n  line-height: 50px;\n}\n\n.profile-menu .el-menu-item:hover {\n  background-color: #f5f7fa;\n}\n\n.profile-menu .el-menu-item.is-active {\n  background-color: #667eea;\n  color: white;\n}\n\n.empty-state {\n  text-align: center;\n  padding: 50px 20px;\n  color: #909399;\n}\n\n.empty-state i {\n  font-size: 48px;\n  margin-bottom: 10px;\n  display: block;\n}\n\n.favorite-item, .comment-item, .view-item {\n  margin-bottom: 15px;\n}\n\n.favorite-content, .comment-content, .view-content {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.favorite-info, .view-info {\n  flex: 1;\n}\n\n.favorite-info h4, .view-info h4 {\n  margin: 0 0 5px 0;\n  color: #333;\n}\n\n.favorite-info p, .view-info p {\n  margin: 0 0 5px 0;\n  color: #666;\n  font-size: 14px;\n}\n\n.price {\n  color: #ff6b6b;\n  font-weight: bold;\n  font-size: 16px;\n}\n\n.comment-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 10px;\n}\n\n.house-name {\n  font-weight: bold;\n  color: #333;\n}\n\n.comment-text {\n  margin: 10px 0;\n  color: #666;\n  line-height: 1.6;\n}\n\n.comment-footer {\n  text-align: right;\n}\n\n.comment-time {\n  color: #909399;\n  font-size: 12px;\n}\n\n.view-time {\n  color: #909399;\n  font-size: 12px;\n}\n</style>"]}]}