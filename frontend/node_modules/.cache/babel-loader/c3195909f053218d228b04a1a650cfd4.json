{"remainingRequest":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\babel-loader\\lib\\index.js!E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\House-Price-Analysis-Spark\\frontend\\src\\views\\User.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\House-Price-Analysis-Spark\\frontend\\src\\views\\User.vue","mtime":1770782206368},{"path":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1769265189153},{"path":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1769265189294},{"path":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1769265189153},{"path":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1769265187754}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdVc2VyJywKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZm9ybURhdGE6IHsKICAgICAgICB1c2VybmFtZTogJycsCiAgICAgICAgZW1haWw6ICcnLAogICAgICAgIHBob25lOiAnJywKICAgICAgICBnZW5kZXI6ICfmnKrnn6UnLAogICAgICAgIG5pY2tuYW1lOiAnJywKICAgICAgICBjaXR5OiAnJywKICAgICAgICBhdmF0YXI6ICcnLAogICAgICAgIGJpcnRoX2RhdGU6ICcnCiAgICAgIH0sCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICB1c2VyOiB7fSwKICAgICAgYXZhdGFyUHJldmlld1VybDogJycsCiAgICAgIGF2YXRhckxvYWRpbmc6IGZhbHNlLAogICAgICBwcmV2aWV3TG9hZGVkOiBmYWxzZSwKICAgICAgcHJldmlld0Vycm9yOiBmYWxzZQogICAgfTsKICB9LAogIGFzeW5jIG1vdW50ZWQoKSB7CiAgICBhd2FpdCB0aGlzLmxvYWRVc2VySW5mbygpOwogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgbG9hZFVzZXJJbmZvKCkgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHVzZXJJbmZvID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJJbmZvJyk7CiAgICAgICAgaWYgKHVzZXJJbmZvKSB7CiAgICAgICAgICB0aGlzLnVzZXIgPSBKU09OLnBhcnNlKHVzZXJJbmZvKTsKICAgICAgICAgIHRoaXMuZm9ybURhdGEgPSB7CiAgICAgICAgICAgIHVzZXJuYW1lOiB0aGlzLnVzZXIudXNlcm5hbWUgfHwgJycsCiAgICAgICAgICAgIGVtYWlsOiB0aGlzLnVzZXIuZW1haWwgfHwgJycsCiAgICAgICAgICAgIHBob25lOiB0aGlzLnVzZXIucGhvbmUgfHwgJycsCiAgICAgICAgICAgIGdlbmRlcjogdGhpcy51c2VyLmdlbmRlciB8fCAn5pyq55+lJywKICAgICAgICAgICAgbmlja25hbWU6IHRoaXMudXNlci5uaWNrbmFtZSB8fCAnJywKICAgICAgICAgICAgY2l0eTogdGhpcy51c2VyLmNpdHkgfHwgJycsCiAgICAgICAgICAgIGF2YXRhcjogdGhpcy51c2VyLmF2YXRhciB8fCAnJywKICAgICAgICAgICAgYmlydGhfZGF0ZTogdGhpcy51c2VyLmJpcnRoX2RhdGUgfHwgJycKICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy4kaHR0cC5nZXQoJy9hcGkvdXNlci91c2VyLWluZm8vJyk7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdWNjZXNzKSB7CiAgICAgICAgICAgIHRoaXMudXNlciA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgICAgdGhpcy5mb3JtRGF0YSA9IHsKICAgICAgICAgICAgICB1c2VybmFtZTogdGhpcy51c2VyLnVzZXJuYW1lIHx8ICcnLAogICAgICAgICAgICAgIGVtYWlsOiB0aGlzLnVzZXIuZW1haWwgfHwgJycsCiAgICAgICAgICAgICAgcGhvbmU6IHRoaXMudXNlci5waG9uZSB8fCAnJywKICAgICAgICAgICAgICBnZW5kZXI6IHRoaXMudXNlci5nZW5kZXIgfHwgJ+acquefpScsCiAgICAgICAgICAgICAgbmlja25hbWU6IHRoaXMudXNlci5uaWNrbmFtZSB8fCAnJywKICAgICAgICAgICAgICBjaXR5OiB0aGlzLnVzZXIuY2l0eSB8fCAnJywKICAgICAgICAgICAgICBhdmF0YXI6IHRoaXMudXNlci5hdmF0YXIgfHwgJycsCiAgICAgICAgICAgICAgYmlydGhfZGF0ZTogdGhpcy51c2VyLmJpcnRoX2RhdGUgfHwgJycKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy8g5Yid5aeL5YyW5aS05YOP6aKE6KeICiAgICAgICAgaWYgKHRoaXMuZm9ybURhdGEuYXZhdGFyKSB7CiAgICAgICAgICB0aGlzLmF2YXRhclByZXZpZXdVcmwgPSB0aGlzLmZvcm1EYXRhLmF2YXRhcjsKICAgICAgICAgIHRoaXMubG9hZEF2YXRhclByZXZpZXcoKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign5Yqg6L2955So5oi35L+h5oGv5aSx6LSlOicsIGVycm9yKTsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfliqDovb3nlKjmiLfkv6Hmga/lpLHotKUnKTsKICAgICAgfQogICAgfSwKICAgIGhhbmRsZUF2YXRhcklucHV0KHZhbHVlKSB7CiAgICAgIC8vIOi+k+WFpeaXtuWunuaXtuabtOaWsOmihOiniFVSTAogICAgICB0aGlzLmF2YXRhclByZXZpZXdVcmwgPSB2YWx1ZTsKICAgICAgdGhpcy5wcmV2aWV3TG9hZGVkID0gZmFsc2U7CiAgICAgIHRoaXMucHJldmlld0Vycm9yID0gZmFsc2U7CgogICAgICAvLyDlpoLmnpzmnInlhoXlrrnvvIzoh6rliqjlsJ3or5XliqDovb0KICAgICAgaWYgKHZhbHVlICYmIHZhbHVlLnRyaW0oKSkgewogICAgICAgIHRoaXMuZGVib3VuY2VMb2FkUHJldmlldygpOwogICAgICB9CiAgICB9LAogICAgZGVib3VuY2VMb2FkUHJldmlldygpIHsKICAgICAgLy8g6Ziy5oqW5aSE55CG77yM6YG/5YWN6aKR57mB6K+35rGCCiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnByZXZpZXdUaW1lcik7CiAgICAgIHRoaXMucHJldmlld1RpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgdGhpcy5sb2FkQXZhdGFyUHJldmlldygpOwogICAgICB9LCA1MDApOwogICAgfSwKICAgIGFzeW5jIGxvYWRBdmF0YXJQcmV2aWV3KCkgewogICAgICBpZiAoIXRoaXMuZm9ybURhdGEuYXZhdGFyIHx8ICF0aGlzLmZvcm1EYXRhLmF2YXRhci50cmltKCkpIHsKICAgICAgICB0aGlzLmF2YXRhclByZXZpZXdVcmwgPSAnJzsKICAgICAgICB0aGlzLnByZXZpZXdMb2FkZWQgPSBmYWxzZTsKICAgICAgICB0aGlzLnByZXZpZXdFcnJvciA9IGZhbHNlOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLmF2YXRhckxvYWRpbmcgPSB0cnVlOwogICAgICB0aGlzLnByZXZpZXdFcnJvciA9IGZhbHNlOwogICAgICB0cnkgewogICAgICAgIC8vIOWIm+W7uuS4gOS4qua1i+ivleWbvueJh+adpemqjOivgVVSTOaYr+WQpuacieaViAogICAgICAgIGNvbnN0IGltZyA9IG5ldyBJbWFnZSgpOwogICAgICAgIGltZy5vbmxvYWQgPSAoKSA9PiB7CiAgICAgICAgICB0aGlzLnByZXZpZXdMb2FkZWQgPSB0cnVlOwogICAgICAgICAgdGhpcy5hdmF0YXJMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICB0aGlzLnByZXZpZXdFcnJvciA9IGZhbHNlOwogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCflpLTlg4/pooTop4jliqDovb3miJDlip8nKTsKICAgICAgICB9OwogICAgICAgIGltZy5vbmVycm9yID0gKCkgPT4gewogICAgICAgICAgdGhpcy5wcmV2aWV3RXJyb3IgPSB0cnVlOwogICAgICAgICAgdGhpcy5hdmF0YXJMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICB0aGlzLnByZXZpZXdMb2FkZWQgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WktOWDj1VSTOaXoOaViOaIluaXoOazleiuv+mXricpOwogICAgICAgIH07CiAgICAgICAgaW1nLnNyYyA9IHRoaXMuZm9ybURhdGEuYXZhdGFyOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIHRoaXMucHJldmlld0Vycm9yID0gdHJ1ZTsKICAgICAgICB0aGlzLmF2YXRhckxvYWRpbmcgPSBmYWxzZTsKICAgICAgICB0aGlzLnByZXZpZXdMb2FkZWQgPSBmYWxzZTsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCflpLTlg4/liqDovb3lpLHotKUnKTsKICAgICAgfQogICAgfSwKICAgIGhhbmRsZVByZXZpZXdMb2FkKCkgewogICAgICB0aGlzLnByZXZpZXdMb2FkZWQgPSB0cnVlOwogICAgICB0aGlzLnByZXZpZXdFcnJvciA9IGZhbHNlOwogICAgfSwKICAgIGhhbmRsZVByZXZpZXdFcnJvcigpIHsKICAgICAgdGhpcy5wcmV2aWV3RXJyb3IgPSB0cnVlOwogICAgICB0aGlzLnByZXZpZXdMb2FkZWQgPSBmYWxzZTsKICAgIH0sCiAgICBoYW5kbGVBdmF0YXJFcnJvcihldmVudCkgewogICAgICAvLyDlpLTlg4/liqDovb3lpLHotKXml7bmmL7npLrpu5jorqTlpLTlg48KICAgICAgZXZlbnQudGFyZ2V0LnNyYyA9ICdodHRwczovL3NzMi5iZHN0YXRpYy5jb20vNzBjRnZYU2hfUTFZbnhHa3BvV0sxSEY2aGh5L2l0L3U9MTY1OTU1Mjc5MiwzODY5MzMyNDk2JmZtPTI1MyZncD0wLmpwZyc7CiAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygn5aS05YOP5Yqg6L295aSx6LSl77yM5bey5L2/55So6buY6K6k5aS05YOPJyk7CiAgICB9LAogICAgYXN5bmMgc2F2ZVVzZXJJbmZvKCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy4kaHR0cC5wdXQoJy9hcGkvdXNlci91cGRhdGUtaW5mby8nLCB7CiAgICAgICAgICBlbWFpbDogdGhpcy5mb3JtRGF0YS5lbWFpbCwKICAgICAgICAgIHBob25lOiB0aGlzLmZvcm1EYXRhLnBob25lLAogICAgICAgICAgZ2VuZGVyOiB0aGlzLmZvcm1EYXRhLmdlbmRlciwKICAgICAgICAgIG5pY2tuYW1lOiB0aGlzLmZvcm1EYXRhLm5pY2tuYW1lLAogICAgICAgICAgY2l0eTogdGhpcy5mb3JtRGF0YS5jaXR5LAogICAgICAgICAgYXZhdGFyOiB0aGlzLmZvcm1EYXRhLmF2YXRhciwKICAgICAgICAgIGJpcnRoX2RhdGU6IHRoaXMuZm9ybURhdGEuYmlydGhfZGF0ZQogICAgICAgIH0pOwogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN1Y2Nlc3MpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5L+d5a2Y5oiQ5Yqf77yBJyk7CgogICAgICAgICAgLy8g5pu05pawbG9jYWxTdG9yYWdlCiAgICAgICAgICBjb25zdCB1cGRhdGVkVXNlciA9IHsKICAgICAgICAgICAgLi4udGhpcy51c2VyLAogICAgICAgICAgICAuLi50aGlzLmZvcm1EYXRhCiAgICAgICAgICB9OwogICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXJJbmZvJywgSlNPTi5zdHJpbmdpZnkodXBkYXRlZFVzZXIpKTsKICAgICAgICAgIHRoaXMudXNlciA9IHVwZGF0ZWRVc2VyOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlc3BvbnNlLmRhdGEubWVzc2FnZSB8fCAn5L+d5a2Y5aSx6LSlJyk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+S/neWtmOWksei0pTonLCBlcnJvcik7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign572R57uc6ZSZ6K+v77yM6K+356iN5ZCO6YeN6K+VJyk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICByZXNldEZvcm0oKSB7CiAgICAgIHRoaXMuZm9ybURhdGEgPSB7CiAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlci51c2VybmFtZSB8fCAnJywKICAgICAgICBlbWFpbDogdGhpcy51c2VyLmVtYWlsIHx8ICcnLAogICAgICAgIHBob25lOiB0aGlzLnVzZXIucGhvbmUgfHwgJycsCiAgICAgICAgZ2VuZGVyOiB0aGlzLnVzZXIuZ2VuZGVyIHx8ICfmnKrnn6UnLAogICAgICAgIG5pY2tuYW1lOiB0aGlzLnVzZXIubmlja25hbWUgfHwgJycsCiAgICAgICAgY2l0eTogdGhpcy51c2VyLmNpdHkgfHwgJycsCiAgICAgICAgYXZhdGFyOiB0aGlzLnVzZXIuYXZhdGFyIHx8ICcnLAogICAgICAgIGJpcnRoX2RhdGU6IHRoaXMudXNlci5iaXJ0aF9kYXRlIHx8ICcnCiAgICAgIH07CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["name","data","formData","username","email","phone","gender","nickname","city","avatar","birth_date","loading","user","avatarPreviewUrl","avatarLoading","previewLoaded","previewError","mounted","loadUserInfo","methods","userInfo","localStorage","getItem","JSON","parse","response","$http","get","success","loadAvatarPreview","error","console","$message","handleAvatarInput","value","trim","debounceLoadPreview","clearTimeout","previewTimer","setTimeout","img","Image","onload","onerror","src","handlePreviewLoad","handlePreviewError","handleAvatarError","event","target","warning","saveUserInfo","put","updatedUser","setItem","stringify","message","resetForm"],"sources":["src/views/User.vue"],"sourcesContent":["<template>\n  <div class=\"user-container\">\n    <h1>个人信息</h1>\n    <p>修改您的个人资料</p>\n    \n    <!-- 头像预览区域 -->\n    <div class=\"avatar-preview-section\">\n      <div class=\"avatar-preview-box\">\n        <img \n          :src=\"formData.avatar || 'https://ss2.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=1659552792,3869332496&fm=253&gp=0.jpg'\" \n          :alt=\"formData.nickname || formData.username\" \n          class=\"avatar-image\"\n          @error=\"handleAvatarError\"\n        />\n        <div class=\"avatar-info\">\n          <p class=\"avatar-text\">头像预览</p>\n          <p class=\"avatar-desc\">支持外部图片链接</p>\n        </div>\n      </div>\n    </div>\n    \n    <el-form :model=\"formData\" ref=\"userForm\" label-width=\"100px\" class=\"user-form\">\n      <el-row :gutter=\"20\">\n        <el-col :span=\"12\">\n          <el-form-item label=\"用户名\" prop=\"username\">\n            <el-input v-model=\"formData.username\" disabled />\n          </el-form-item>\n          <el-form-item label=\"邮箱\" prop=\"email\">\n            <el-input v-model=\"formData.email\" />\n          </el-form-item>\n          <el-form-item label=\"手机号\" prop=\"phone\">\n            <el-input v-model=\"formData.phone\" />\n          </el-form-item>\n          <el-form-item label=\"性别\" prop=\"gender\">\n            <el-select v-model=\"formData.gender\">\n              <el-option label=\"男\" value=\"男\"></el-option>\n              <el-option label=\"女\" value=\"女\"></el-option>\n              <el-option label=\"未知\" value=\"未知\"></el-option>\n            </el-select>\n          </el-form-item>\n        </el-col>\n        \n        <el-col :span=\"12\">\n          <el-form-item label=\"昵称\" prop=\"nickname\">\n            <el-input v-model=\"formData.nickname\" />\n          </el-form-item>\n          <el-form-item label=\"城市\" prop=\"city\">\n            <el-input v-model=\"formData.city\" />\n          </el-form-item>\n          <el-form-item label=\"头像URL\" prop=\"avatar\">\n            <el-input \n              v-model=\"formData.avatar\" \n              placeholder=\"请输入图片URL地址\"\n              @input=\"handleAvatarInput\"\n            >\n              <template #append>\n                <el-button @click=\"loadAvatarPreview\" :loading=\"avatarLoading\">加载</el-button>\n              </template>\n            </el-input>\n            <div v-if=\"avatarPreviewUrl\" class=\"avatar-preview-result\">\n              <img \n                :src=\"avatarPreviewUrl\" \n                alt=\"头像预览\" \n                class=\"preview-image\"\n                @error=\"handlePreviewError\"\n                @load=\"handlePreviewLoad\"\n              />\n              <span class=\"preview-status success\" v-if=\"previewLoaded\">✓ 预览成功</span>\n              <span class=\"preview-status error\" v-else-if=\"previewError\">✗ 加载失败</span>\n              <span class=\"preview-status loading\" v-else>加载中...</span>\n            </div>\n          </el-form-item>\n          <el-form-item label=\"出生日期\" prop=\"birth_date\">\n            <el-date-picker v-model=\"formData.birth_date\" type=\"date\" value-format=\"yyyy-MM-dd\" />\n          </el-form-item>\n        </el-col>\n      </el-row>\n      \n      <div class=\"form-actions\">\n        <el-button type=\"primary\" @click=\"saveUserInfo\" :loading=\"loading\">保存修改</el-button>\n        <el-button @click=\"resetForm\">重置</el-button>\n        <el-button @click=\"$router.push('/')\">返回</el-button>\n      </div>\n    </el-form>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'User',\n  data() {\n    return {\n      formData: {\n        username: '',\n        email: '',\n        phone: '',\n        gender: '未知',\n        nickname: '',\n        city: '',\n        avatar: '',\n        birth_date: ''\n      },\n      loading: false,\n      user: {},\n      avatarPreviewUrl: '',\n      avatarLoading: false,\n      previewLoaded: false,\n      previewError: false\n    }\n  },\n  async mounted() {\n    await this.loadUserInfo()\n  },\n  methods: {\n    async loadUserInfo() {\n      try {\n        const userInfo = localStorage.getItem('userInfo')\n        if (userInfo) {\n          this.user = JSON.parse(userInfo)\n          this.formData = {\n            username: this.user.username || '',\n            email: this.user.email || '',\n            phone: this.user.phone || '',\n            gender: this.user.gender || '未知',\n            nickname: this.user.nickname || '',\n            city: this.user.city || '',\n            avatar: this.user.avatar || '',\n            birth_date: this.user.birth_date || ''\n          }\n        } else {\n          const response = await this.$http.get('/api/user/user-info/')\n          if (response.data.success) {\n            this.user = response.data.data\n            this.formData = {\n              username: this.user.username || '',\n              email: this.user.email || '',\n              phone: this.user.phone || '',\n              gender: this.user.gender || '未知',\n              nickname: this.user.nickname || '',\n              city: this.user.city || '',\n              avatar: this.user.avatar || '',\n              birth_date: this.user.birth_date || ''\n            }\n          }\n        }\n        // 初始化头像预览\n        if (this.formData.avatar) {\n          this.avatarPreviewUrl = this.formData.avatar\n          this.loadAvatarPreview()\n        }\n      } catch (error) {\n        console.error('加载用户信息失败:', error)\n        this.$message.error('加载用户信息失败')\n      }\n    },\n    \n    handleAvatarInput(value) {\n      // 输入时实时更新预览URL\n      this.avatarPreviewUrl = value\n      this.previewLoaded = false\n      this.previewError = false\n      \n      // 如果有内容，自动尝试加载\n      if (value && value.trim()) {\n        this.debounceLoadPreview()\n      }\n    },\n    \n    debounceLoadPreview() {\n      // 防抖处理，避免频繁请求\n      clearTimeout(this.previewTimer)\n      this.previewTimer = setTimeout(() => {\n        this.loadAvatarPreview()\n      }, 500)\n    },\n    \n    async loadAvatarPreview() {\n      if (!this.formData.avatar || !this.formData.avatar.trim()) {\n        this.avatarPreviewUrl = ''\n        this.previewLoaded = false\n        this.previewError = false\n        return\n      }\n      \n      this.avatarLoading = true\n      this.previewError = false\n      \n      try {\n        // 创建一个测试图片来验证URL是否有效\n        const img = new Image()\n        img.onload = () => {\n          this.previewLoaded = true\n          this.avatarLoading = false\n          this.previewError = false\n          this.$message.success('头像预览加载成功')\n        }\n        img.onerror = () => {\n          this.previewError = true\n          this.avatarLoading = false\n          this.previewLoaded = false\n          this.$message.error('头像URL无效或无法访问')\n        }\n        img.src = this.formData.avatar\n      } catch (error) {\n        this.previewError = true\n        this.avatarLoading = false\n        this.previewLoaded = false\n        this.$message.error('头像加载失败')\n      }\n    },\n    \n    handlePreviewLoad() {\n      this.previewLoaded = true\n      this.previewError = false\n    },\n    \n    handlePreviewError() {\n      this.previewError = true\n      this.previewLoaded = false\n    },\n    \n    handleAvatarError(event) {\n      // 头像加载失败时显示默认头像\n      event.target.src = 'https://ss2.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=1659552792,3869332496&fm=253&gp=0.jpg'\n\n      this.$message.warning('头像加载失败，已使用默认头像')\n    },\n    \n    async saveUserInfo() {\n      this.loading = true\n      try {\n        const response = await this.$http.put('/api/user/update-info/', {\n          email: this.formData.email,\n          phone: this.formData.phone,\n          gender: this.formData.gender,\n          nickname: this.formData.nickname,\n          city: this.formData.city,\n          avatar: this.formData.avatar,\n          birth_date: this.formData.birth_date\n        })\n        \n        if (response.data.success) {\n          this.$message.success('保存成功！')\n          \n          // 更新localStorage\n          const updatedUser = { ...this.user, ...this.formData }\n          localStorage.setItem('userInfo', JSON.stringify(updatedUser))\n          this.user = updatedUser\n        } else {\n          this.$message.error(response.data.message || '保存失败')\n        }\n      } catch (error) {\n        console.error('保存失败:', error)\n        this.$message.error('网络错误，请稍后重试')\n      } finally {\n        this.loading = false\n      }\n    },\n    \n    resetForm() {\n      this.formData = {\n        username: this.user.username || '',\n        email: this.user.email || '',\n        phone: this.user.phone || '',\n        gender: this.user.gender || '未知',\n        nickname: this.user.nickname || '',\n        city: this.user.city || '',\n        avatar: this.user.avatar || '',\n        birth_date: this.user.birth_date || ''\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.user-container {\n  padding: 20px;\n  max-width: 800px;\n  margin: 0 auto;\n}\n\n.user-container h1 {\n  color: #333;\n  font-size: 24px;\n  margin-bottom: 8px;\n}\n\n.user-container p {\n  color: #666;\n  font-size: 14px;\n  margin-bottom: 20px;\n}\n\n.avatar-preview-section {\n  margin-bottom: 24px;\n}\n\n.avatar-preview-box {\n  display: flex;\n  align-items: center;\n  gap: 20px;\n  background: #f5f7fa;\n  border-radius: 12px;\n  padding: 20px;\n}\n\n.avatar-image {\n  width: 120px;\n  height: 120px;\n  border-radius: 50%;\n  object-fit: cover;\n  border: 2px solid #e1e5e9;\n  box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n}\n\n.avatar-info {\n  text-align: left;\n}\n\n.avatar-text {\n  color: #333;\n  font-weight: 500;\n  margin-bottom: 4px;\n}\n\n.avatar-desc {\n  color: #666;\n  font-size: 12px;\n}\n\n.avatar-preview-result {\n  margin-top: 10px;\n  text-align: center;\n}\n\n.preview-image {\n  width: 80px;\n  height: 80px;\n  border-radius: 50%;\n  object-fit: cover;\n  border: 2px solid #e1e5e9;\n  box-shadow: 0 2px 6px rgba(0,0,0,0.1);\n  margin-bottom: 8px;\n}\n\n.preview-status {\n  font-size: 12px;\n  font-weight: 500;\n}\n\n.preview-status.success {\n  color: #67c23a;\n}\n\n.preview-status.error {\n  color: #f56c6c;\n}\n\n.preview-status.loading {\n  color: #409eff;\n}\n\n.user-form {\n  background: white;\n  border-radius: 12px;\n  padding: 24px;\n  box-shadow: 0 4px 15px rgba(0,0,0,0.1);\n}\n\n.form-actions {\n  margin-top: 20px;\n}\n</style>"],"mappings":"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","ignoreList":[]}]}