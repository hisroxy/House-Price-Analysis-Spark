{"remainingRequest":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\House-Price-Analysis-Spark\\frontend\\src\\views\\UserCenter.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\House-Price-Analysis-Spark\\frontend\\src\\views\\UserCenter.vue","mtime":1770782206365},{"path":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1769265189153},{"path":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1769265189294},{"path":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1769265189153},{"path":"E:\\House-Price-Analysis-Spark\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1769265187754}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnVXNlckNlbnRlcicsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGFjdGl2ZU1lbnU6ICdwcm9maWxlJywKICAgICAgdXNlclByb2ZpbGU6IHt9LAogICAgICBmYXZvcml0ZXM6IFtdLAogICAgICBjb21tZW50czogW10sCiAgICAgIGJyb3dzZUhpc3Rvcnk6IFtdLAogICAgICBjbGlja0JlaGF2aW9yczogW10KICAgIH0KICB9LAogIGFzeW5jIG1vdW50ZWQoKSB7CiAgICBpZiAoIXRoaXMuaXNBdXRoZW50aWNhdGVkKCkpIHsKICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfor7flhYjnmbvlvZUnKQogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL2xvZ2luJykKICAgICAgcmV0dXJuCiAgICB9CiAgICBhd2FpdCB0aGlzLmxvYWRVc2VyRGF0YSgpCiAgfSwKICBtZXRob2RzOiB7CiAgICBoYW5kbGVNZW51U2VsZWN0KGtleSkgewogICAgICB0aGlzLmFjdGl2ZU1lbnUgPSBrZXkKICAgIH0sCiAgICAKICAgIGFzeW5jIGxvYWRVc2VyRGF0YSgpIHsKICAgICAgdHJ5IHsKICAgICAgICAvLyDliqDovb3nlKjmiLfln7rmnKzkv6Hmga8KICAgICAgICBjb25zdCB1c2VySW5mbyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VySW5mbycpCiAgICAgICAgaWYgKHVzZXJJbmZvKSB7CiAgICAgICAgICB0aGlzLnVzZXJQcm9maWxlID0gSlNPTi5wYXJzZSh1c2VySW5mbykKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8g5Yqg6L295pS26JeP5pWw5o2uCiAgICAgICAgY29uc3QgZmF2UmVzcG9uc2UgPSBhd2FpdCB0aGlzLiRodHRwLmdldCgnL2FwaS91c2VyL2Zhdm9yaXRlcy8nKQogICAgICAgIGlmIChmYXZSZXNwb25zZS5kYXRhLnN1Y2Nlc3MpIHsKICAgICAgICAgIHRoaXMuZmF2b3JpdGVzID0gZmF2UmVzcG9uc2UuZGF0YS5kYXRhCiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIOWKoOi9veivhOiuuuaVsOaNrgogICAgICAgIGNvbnN0IGNvbW1lbnRSZXNwb25zZSA9IGF3YWl0IHRoaXMuJGh0dHAuZ2V0KCcvYXBpL3VzZXIvY29tbWVudHMvJykKICAgICAgICBpZiAoY29tbWVudFJlc3BvbnNlLmRhdGEuc3VjY2VzcykgewogICAgICAgICAgdGhpcy5jb21tZW50cyA9IGNvbW1lbnRSZXNwb25zZS5kYXRhLmRhdGEKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8g5Yqg6L295rWP6KeI6K6w5b2VCiAgICAgICAgY29uc3QgaGlzdG9yeVJlc3BvbnNlID0gYXdhaXQgdGhpcy4kaHR0cC5nZXQoJy9hcGkvdXNlci9icm93c2UtaGlzdG9yeS8nKQogICAgICAgIGlmIChoaXN0b3J5UmVzcG9uc2UuZGF0YS5zdWNjZXNzKSB7CiAgICAgICAgICB0aGlzLmJyb3dzZUhpc3RvcnkgPSBoaXN0b3J5UmVzcG9uc2UuZGF0YS5kYXRhCiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIOWKoOi9veeCueWHu+ihjOS4ugogICAgICAgIGNvbnN0IGNsaWNrUmVzcG9uc2UgPSBhd2FpdCB0aGlzLiRodHRwLmdldCgnL2FwaS91c2VyL2NsaWNrLWJlaGF2aW9ycy8nKQogICAgICAgIGlmIChjbGlja1Jlc3BvbnNlLmRhdGEuc3VjY2VzcykgewogICAgICAgICAgdGhpcy5jbGlja0JlaGF2aW9ycyA9IGNsaWNrUmVzcG9uc2UuZGF0YS5kYXRhCiAgICAgICAgfQogICAgICAgIAogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WKoOi9veeUqOaIt+aVsOaNruWksei0pTonLCBlcnJvcikKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfmlbDmja7liqDovb3lpLHotKUnKQogICAgICB9CiAgICB9LAogICAgCiAgICBhc3luYyBjYW5jZWxGYXZvcml0ZShyb3cpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuJGh0dHAucG9zdCgnL2FwaS9ob3VzZXMvdG9nZ2xlLWZhdm9yaXRlLycsIHsKICAgICAgICAgIGhvdXNlX2lkOiByb3cuaG91c2VfaWQKICAgICAgICB9KQogICAgICAgIAogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN1Y2Nlc3MpIHsKICAgICAgICAgIHJvdy5pc19hY3RpdmUgPSBmYWxzZQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCflj5bmtojmlLbol4/miJDlip8nKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlc3BvbnNlLmRhdGEubWVzc2FnZSkKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign5Y+W5raI5pS26JeP5aSx6LSlOicsIGVycm9yKQogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+aTjeS9nOWksei0pScpCiAgICAgIH0KICAgIH0sCiAgICAKICAgIGlzQXV0aGVudGljYXRlZCgpIHsKICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdpc0F1dGhlbnRpY2F0ZWQnKSA9PT0gJ3RydWUnCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["UserCenter.vue"],"names":[],"mappings":";AA6IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"UserCenter.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"user-center-container\">\n    <h1>个人中心</h1>\n    \n    <el-row :gutter=\"20\">\n      <!-- 左侧导航菜单 -->\n      <el-col :span=\"6\">\n        <el-menu\n          :default-active=\"activeMenu\"\n          class=\"user-menu\"\n          @select=\"handleMenuSelect\"\n        >\n          <el-menu-item index=\"profile\">\n            <i class=\"el-icon-user\"></i>\n            <span>个人资料</span>\n          </el-menu-item>\n          <el-menu-item index=\"favorites\">\n            <i class=\"el-icon-star-on\"></i>\n            <span>我的收藏</span>\n          </el-menu-item>\n          <el-menu-item index=\"comments\">\n            <i class=\"el-icon-chat-dot-round\"></i>\n            <span>我的评论</span>\n          </el-menu-item>\n          <el-menu-item index=\"browse-history\">\n            <i class=\"el-icon-time\"></i>\n            <span>浏览记录</span>\n          </el-menu-item>\n          <el-menu-item index=\"click-behavior\">\n            <i class=\"el-icon-mouse\"></i>\n            <span>点击行为</span>\n          </el-menu-item>\n        </el-menu>\n      </el-col>\n      \n      <!-- 右侧内容区域 -->\n      <el-col :span=\"18\">\n        <el-card class=\"content-card\">\n          <!-- 个人资料 -->\n          <div v-if=\"activeMenu === 'profile'\">\n            <div class=\"section-header\">\n              <h2>个人资料</h2>\n              <el-button type=\"primary\" @click=\"$router.push('/user')\">修改资料</el-button>\n            </div>\n            <el-descriptions :column=\"2\" border>\n              <el-descriptions-item label=\"用户名\">{{ userProfile.username }}</el-descriptions-item>\n              <el-descriptions-item label=\"昵称\">{{ userProfile.nickname }}</el-descriptions-item>\n              <el-descriptions-item label=\"邮箱\">{{ userProfile.email }}</el-descriptions-item>\n              <el-descriptions-item label=\"手机号\">{{ userProfile.phone }}</el-descriptions-item>\n              <el-descriptions-item label=\"性别\">{{ userProfile.gender }}</el-descriptions-item>\n              <el-descriptions-item label=\"城市\">{{ userProfile.city }}</el-descriptions-item>\n              <el-descriptions-item label=\"出生日期\">{{ userProfile.birth_date }}</el-descriptions-item>\n              <el-descriptions-item label=\"注册时间\">{{ userProfile.created_at }}</el-descriptions-item>\n            </el-descriptions>\n          </div>\n          \n          <!-- 我的收藏 -->\n          <div v-else-if=\"activeMenu === 'favorites'\">\n            <div class=\"section-header\">\n              <h2>我的收藏 ({{ favorites.length }})</h2>\n            </div>\n            <el-table :data=\"favorites\" style=\"width: 100%\">\n              <el-table-column prop=\"house_id\" label=\"房屋ID\" width=\"180\"></el-table-column>\n              <el-table-column prop=\"favorited_at\" label=\"收藏时间\" width=\"180\"></el-table-column>\n              <el-table-column label=\"状态\" width=\"100\">\n                <template slot-scope=\"scope\">\n                  <el-tag :type=\"scope.row.is_active ? 'success' : 'info'\">\n                    {{ scope.row.is_active ? '已收藏' : '已取消' }}\n                  </el-tag>\n                </template>\n              </el-table-column>\n              <el-table-column label=\"操作\">\n                <template slot-scope=\"scope\">\n                  <el-button \n                    v-if=\"scope.row.is_active\"\n                    size=\"mini\" \n                    type=\"danger\" \n                    @click=\"cancelFavorite(scope.row)\"\n                  >\n                    取消收藏\n                  </el-button>\n                </template>\n              </el-table-column>\n            </el-table>\n          </div>\n          \n          <!-- 我的评论 -->\n          <div v-else-if=\"activeMenu === 'comments'\">\n            <div class=\"section-header\">\n              <h2>我的评论 ({{ comments.length }})</h2>\n            </div>\n            <el-table :data=\"comments\" style=\"width: 100%\">\n              <el-table-column prop=\"house_id\" label=\"房屋ID\" width=\"180\"></el-table-column>\n              <el-table-column prop=\"comment\" label=\"评论内容\"></el-table-column>\n              <el-table-column prop=\"rating\" label=\"评分\" width=\"100\">\n                <template slot-scope=\"scope\">\n                  <el-rate\n                    v-if=\"scope.row.rating\"\n                    v-model=\"scope.row.rating\"\n                    disabled\n                    show-score\n                    text-color=\"#ff9900\"\n                  ></el-rate>\n                  <span v-else>无评分</span>\n                </template>\n              </el-table-column>\n              <el-table-column prop=\"commented_at\" label=\"评论时间\" width=\"180\"></el-table-column>\n            </el-table>\n          </div>\n          \n          <!-- 浏览记录 -->\n          <div v-else-if=\"activeMenu === 'browse-history'\">\n            <div class=\"section-header\">\n              <h2>浏览记录 ({{ browseHistory.length }})</h2>\n            </div>\n            <el-table :data=\"browseHistory\" style=\"width: 100%\">\n              <el-table-column prop=\"house_id\" label=\"房屋ID\" width=\"180\"></el-table-column>\n              <el-table-column prop=\"viewed_at\" label=\"浏览时间\" width=\"180\"></el-table-column>\n              <el-table-column prop=\"duration\" label=\"浏览时长(秒)\" width=\"120\"></el-table-column>\n              <el-table-column prop=\"session_id\" label=\"会话ID\"></el-table-column>\n            </el-table>\n          </div>\n          \n          <!-- 点击行为 -->\n          <div v-else-if=\"activeMenu === 'click-behavior'\">\n            <div class=\"section-header\">\n              <h2>点击行为 ({{ clickBehaviors.length }})</h2>\n            </div>\n            <el-table :data=\"clickBehaviors\" style=\"width: 100%\">\n              <el-table-column prop=\"house_id\" label=\"房屋ID\" width=\"180\"></el-table-column>\n              <el-table-column prop=\"clicked_at\" label=\"点击时间\" width=\"180\"></el-table-column>\n              <el-table-column prop=\"session_id\" label=\"会话ID\"></el-table-column>\n            </el-table>\n          </div>\n        </el-card>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'UserCenter',\n  data() {\n    return {\n      activeMenu: 'profile',\n      userProfile: {},\n      favorites: [],\n      comments: [],\n      browseHistory: [],\n      clickBehaviors: []\n    }\n  },\n  async mounted() {\n    if (!this.isAuthenticated()) {\n      this.$message.warning('请先登录')\n      this.$router.push('/login')\n      return\n    }\n    await this.loadUserData()\n  },\n  methods: {\n    handleMenuSelect(key) {\n      this.activeMenu = key\n    },\n    \n    async loadUserData() {\n      try {\n        // 加载用户基本信息\n        const userInfo = localStorage.getItem('userInfo')\n        if (userInfo) {\n          this.userProfile = JSON.parse(userInfo)\n        }\n        \n        // 加载收藏数据\n        const favResponse = await this.$http.get('/api/user/favorites/')\n        if (favResponse.data.success) {\n          this.favorites = favResponse.data.data\n        }\n        \n        // 加载评论数据\n        const commentResponse = await this.$http.get('/api/user/comments/')\n        if (commentResponse.data.success) {\n          this.comments = commentResponse.data.data\n        }\n        \n        // 加载浏览记录\n        const historyResponse = await this.$http.get('/api/user/browse-history/')\n        if (historyResponse.data.success) {\n          this.browseHistory = historyResponse.data.data\n        }\n        \n        // 加载点击行为\n        const clickResponse = await this.$http.get('/api/user/click-behaviors/')\n        if (clickResponse.data.success) {\n          this.clickBehaviors = clickResponse.data.data\n        }\n        \n      } catch (error) {\n        console.error('加载用户数据失败:', error)\n        this.$message.error('数据加载失败')\n      }\n    },\n    \n    async cancelFavorite(row) {\n      try {\n        const response = await this.$http.post('/api/houses/toggle-favorite/', {\n          house_id: row.house_id\n        })\n        \n        if (response.data.success) {\n          row.is_active = false\n          this.$message.success('取消收藏成功')\n        } else {\n          this.$message.error(response.data.message)\n        }\n      } catch (error) {\n        console.error('取消收藏失败:', error)\n        this.$message.error('操作失败')\n      }\n    },\n    \n    isAuthenticated() {\n      return localStorage.getItem('isAuthenticated') === 'true'\n    }\n  }\n}\n</script>\n\n<style scoped>\n.user-center-container {\n  padding: 20px;\n  background-color: #f5f7fa;\n  min-height: calc(100vh - 60px);\n}\n\n.user-center-container h1 {\n  color: #333;\n  margin-bottom: 20px;\n}\n\n.user-menu {\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.user-menu .el-menu-item {\n  height: 50px;\n  line-height: 50px;\n}\n\n.user-menu .el-menu-item i {\n  margin-right: 10px;\n  color: #667eea;\n}\n\n.content-card {\n  min-height: 500px;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n  padding-bottom: 15px;\n  border-bottom: 1px solid #eee;\n}\n\n.section-header h2 {\n  margin: 0;\n  color: #333;\n}\n</style>"]}]}